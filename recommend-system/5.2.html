<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>5.2-向量化召回 | 阿药算法</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" href="/favicon.ico">
    <meta name="description" content="打通算法面试任督二脉">
    <meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no">
    
    <link rel="preload" href="/assets/css/0.styles.fe6dc972.css" as="style"><link rel="preload" href="/assets/js/app.8518e532.js" as="script"><link rel="preload" href="/assets/js/3.01b1ada6.js" as="script"><link rel="preload" href="/assets/js/1.f343df0c.js" as="script"><link rel="preload" href="/assets/js/61.52a7d43a.js" as="script"><link rel="prefetch" href="/assets/js/10.8f5f369f.js"><link rel="prefetch" href="/assets/js/100.316e5ee5.js"><link rel="prefetch" href="/assets/js/101.fad72190.js"><link rel="prefetch" href="/assets/js/102.c8654f67.js"><link rel="prefetch" href="/assets/js/103.0ef90d2e.js"><link rel="prefetch" href="/assets/js/104.74905eda.js"><link rel="prefetch" href="/assets/js/105.88b053eb.js"><link rel="prefetch" href="/assets/js/106.07e74ccb.js"><link rel="prefetch" href="/assets/js/107.6cf4888b.js"><link rel="prefetch" href="/assets/js/108.088d9ab7.js"><link rel="prefetch" href="/assets/js/109.81b513ba.js"><link rel="prefetch" href="/assets/js/11.3a9d991e.js"><link rel="prefetch" href="/assets/js/110.4405687c.js"><link rel="prefetch" href="/assets/js/111.84f52e51.js"><link rel="prefetch" href="/assets/js/112.0835627e.js"><link rel="prefetch" href="/assets/js/113.f52a64f8.js"><link rel="prefetch" href="/assets/js/114.78c71883.js"><link rel="prefetch" href="/assets/js/115.1bc75f87.js"><link rel="prefetch" href="/assets/js/116.23247ca8.js"><link rel="prefetch" href="/assets/js/117.c2a03d05.js"><link rel="prefetch" href="/assets/js/118.06a99a45.js"><link rel="prefetch" href="/assets/js/119.02819cc6.js"><link rel="prefetch" href="/assets/js/12.ead6404b.js"><link rel="prefetch" href="/assets/js/120.4c7f544e.js"><link rel="prefetch" href="/assets/js/121.17af8971.js"><link rel="prefetch" href="/assets/js/122.b2d58f28.js"><link rel="prefetch" href="/assets/js/123.cd824d89.js"><link rel="prefetch" href="/assets/js/124.8ba0617f.js"><link rel="prefetch" href="/assets/js/125.dae1d43d.js"><link rel="prefetch" href="/assets/js/126.766c680b.js"><link rel="prefetch" href="/assets/js/127.0ba89f98.js"><link rel="prefetch" href="/assets/js/13.3f47e407.js"><link rel="prefetch" href="/assets/js/14.4214c90a.js"><link rel="prefetch" href="/assets/js/15.d8b35316.js"><link rel="prefetch" href="/assets/js/16.5c3cca68.js"><link rel="prefetch" href="/assets/js/17.b1afd92a.js"><link rel="prefetch" href="/assets/js/18.5d5af7f0.js"><link rel="prefetch" href="/assets/js/19.dff93588.js"><link rel="prefetch" href="/assets/js/20.84b24def.js"><link rel="prefetch" href="/assets/js/21.fddc8d57.js"><link rel="prefetch" href="/assets/js/22.a2256c87.js"><link rel="prefetch" href="/assets/js/23.e99271f0.js"><link rel="prefetch" href="/assets/js/24.6f57ed45.js"><link rel="prefetch" href="/assets/js/25.f94e1138.js"><link rel="prefetch" href="/assets/js/26.95703874.js"><link rel="prefetch" href="/assets/js/27.862053ac.js"><link rel="prefetch" href="/assets/js/28.484b0f92.js"><link rel="prefetch" href="/assets/js/29.a6bc4696.js"><link rel="prefetch" href="/assets/js/30.899ae475.js"><link rel="prefetch" href="/assets/js/31.c0692275.js"><link rel="prefetch" href="/assets/js/32.f432af29.js"><link rel="prefetch" href="/assets/js/33.53298676.js"><link rel="prefetch" href="/assets/js/34.8453251e.js"><link rel="prefetch" href="/assets/js/35.4ad02f32.js"><link rel="prefetch" href="/assets/js/36.e2020b55.js"><link rel="prefetch" href="/assets/js/37.bd0d762c.js"><link rel="prefetch" href="/assets/js/38.28b40e69.js"><link rel="prefetch" href="/assets/js/39.2a062550.js"><link rel="prefetch" href="/assets/js/4.bd6af1c3.js"><link rel="prefetch" href="/assets/js/40.26b798f5.js"><link rel="prefetch" href="/assets/js/41.d4a79f05.js"><link rel="prefetch" href="/assets/js/42.d7d3e46f.js"><link rel="prefetch" href="/assets/js/43.dd97af95.js"><link rel="prefetch" href="/assets/js/44.d80ed9c3.js"><link rel="prefetch" href="/assets/js/45.0160eb21.js"><link rel="prefetch" href="/assets/js/46.e1745185.js"><link rel="prefetch" href="/assets/js/47.fffc13d4.js"><link rel="prefetch" href="/assets/js/48.36febb98.js"><link rel="prefetch" href="/assets/js/49.af73c65e.js"><link rel="prefetch" href="/assets/js/5.d40f878d.js"><link rel="prefetch" href="/assets/js/50.7d54afcb.js"><link rel="prefetch" href="/assets/js/51.f16113b0.js"><link rel="prefetch" href="/assets/js/52.81185856.js"><link rel="prefetch" href="/assets/js/53.68720d69.js"><link rel="prefetch" href="/assets/js/54.e8342836.js"><link rel="prefetch" href="/assets/js/55.8b4a107b.js"><link rel="prefetch" href="/assets/js/56.ce0dfd6e.js"><link rel="prefetch" href="/assets/js/57.05e76878.js"><link rel="prefetch" href="/assets/js/58.ba13d18b.js"><link rel="prefetch" href="/assets/js/59.a2542f17.js"><link rel="prefetch" href="/assets/js/6.12f07f50.js"><link rel="prefetch" href="/assets/js/60.400d49b9.js"><link rel="prefetch" href="/assets/js/62.33129860.js"><link rel="prefetch" href="/assets/js/63.23ce5a1c.js"><link rel="prefetch" href="/assets/js/64.eddafc14.js"><link rel="prefetch" href="/assets/js/65.56733127.js"><link rel="prefetch" href="/assets/js/66.74b3800e.js"><link rel="prefetch" href="/assets/js/67.6d78b237.js"><link rel="prefetch" href="/assets/js/68.4e75b203.js"><link rel="prefetch" href="/assets/js/69.fb86f086.js"><link rel="prefetch" href="/assets/js/7.4a995ca6.js"><link rel="prefetch" href="/assets/js/70.5e4eeed1.js"><link rel="prefetch" href="/assets/js/71.1d58b2eb.js"><link rel="prefetch" href="/assets/js/72.0db49304.js"><link rel="prefetch" href="/assets/js/73.8559ae22.js"><link rel="prefetch" href="/assets/js/74.1d9b18d8.js"><link rel="prefetch" href="/assets/js/75.533946ea.js"><link rel="prefetch" href="/assets/js/76.c3db5bcc.js"><link rel="prefetch" href="/assets/js/77.dbbaad4f.js"><link rel="prefetch" href="/assets/js/78.3249bf8c.js"><link rel="prefetch" href="/assets/js/79.0e1f4de7.js"><link rel="prefetch" href="/assets/js/8.65dc42f1.js"><link rel="prefetch" href="/assets/js/80.cb0e11ca.js"><link rel="prefetch" href="/assets/js/81.56378651.js"><link rel="prefetch" href="/assets/js/82.cc47393e.js"><link rel="prefetch" href="/assets/js/83.e3587b1d.js"><link rel="prefetch" href="/assets/js/84.a2ccc99a.js"><link rel="prefetch" href="/assets/js/85.ecbf6f01.js"><link rel="prefetch" href="/assets/js/86.e6c7c417.js"><link rel="prefetch" href="/assets/js/87.ac1f2e2e.js"><link rel="prefetch" href="/assets/js/88.5238dd17.js"><link rel="prefetch" href="/assets/js/89.c11c295e.js"><link rel="prefetch" href="/assets/js/9.9cecf183.js"><link rel="prefetch" href="/assets/js/90.c9f297b4.js"><link rel="prefetch" href="/assets/js/91.97568d6a.js"><link rel="prefetch" href="/assets/js/92.c9a4b860.js"><link rel="prefetch" href="/assets/js/93.71530ed1.js"><link rel="prefetch" href="/assets/js/94.098fe0b7.js"><link rel="prefetch" href="/assets/js/95.cf5a1bd5.js"><link rel="prefetch" href="/assets/js/96.1aa633ad.js"><link rel="prefetch" href="/assets/js/97.e19d2c4e.js"><link rel="prefetch" href="/assets/js/98.2c1dfac1.js"><link rel="prefetch" href="/assets/js/99.a951db26.js">
    <link rel="stylesheet" href="/assets/css/0.styles.fe6dc972.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container" data-v-1156296a><div data-v-1156296a><div id="loader-wrapper" class="loading-wrapper" data-v-d48f4d20 data-v-1156296a data-v-1156296a><div class="loader-main" data-v-d48f4d20><div data-v-d48f4d20></div><div data-v-d48f4d20></div><div data-v-d48f4d20></div><div data-v-d48f4d20></div></div> <!----> <!----></div> <div class="password-shadow password-wrapper-out" style="display:none;" data-v-4e82dffc data-v-1156296a data-v-1156296a><h3 class="title" data-v-4e82dffc data-v-4e82dffc>阿药算法</h3> <p class="description" data-v-4e82dffc data-v-4e82dffc>打通算法面试任督二脉</p> <label id="box" class="inputBox" data-v-4e82dffc data-v-4e82dffc><input type="password" value="" data-v-4e82dffc> <span data-v-4e82dffc>Konck! Knock!</span> <button data-v-4e82dffc>OK</button></label> <div class="footer" data-v-4e82dffc data-v-4e82dffc><span data-v-4e82dffc><i class="iconfont reco-theme" data-v-4e82dffc></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-4e82dffc>vuePress-theme-reco</a></span> <span data-v-4e82dffc><i class="iconfont reco-copyright" data-v-4e82dffc></i> <a data-v-4e82dffc><span data-v-4e82dffc>阿药</span>
            
          <span data-v-4e82dffc>2021 - </span>
          2023
        </a></span></div></div> <div class="hide" data-v-1156296a><header class="navbar" data-v-1156296a><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/logo.png" alt="阿药算法" class="logo"> <span class="site-name">阿药算法</span></a> <div class="links"><div class="color-picker"><a class="color-button"><i class="iconfont reco-color"></i></a> <div class="color-picker-menu" style="display:none;"><div class="mode-options"><h4 class="title">Choose mode</h4> <ul class="color-mode-options"><li class="dark">dark</li><li class="auto active">auto</li><li class="light">light</li></ul></div></div></div> <div class="search-box"><i class="iconfont reco-search"></i> <input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link"><i class="iconfont reco-home"></i>
  主页
</a></div><div class="nav-item"><a href="/ml/" class="nav-link"><i class="fa fa-laptop-code"></i>
  机器学习
</a></div><div class="nav-item"><a href="/recommend-system/" class="nav-link router-link-active"><i class="fa fa-assistive-listening-systems"></i>
  推荐系统
</a></div><div class="nav-item"><a href="/nlp/" class="nav-link"><i class="fa fa-language"></i>
  自然语言处理
</a></div><div class="nav-item"><a href="/leetcode/" class="nav-link"><i class="fa fa-file-code"></i>
  Leetcode
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-message"></i>
      Contact
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://mp.weixin.qq.com/s/tddJF6sPAsDf1psqwfXHlg" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont reco-wechat"></i>
  公众号
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://www.zhihu.com/people/zhang-hua-28-4" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont reco-zhihu"></i>
  知乎
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask" data-v-1156296a></div> <aside class="sidebar" data-v-1156296a><div class="personal-info-wrapper" data-v-828910c6 data-v-1156296a><img src="/avatar.png" alt="author-avatar" class="personal-img" data-v-828910c6> <h3 class="name" data-v-828910c6>
    阿药
  </h3> <div class="num" data-v-828910c6><div data-v-828910c6><h3 data-v-828910c6>117</h3> <h6 data-v-828910c6>Articles</h6></div> <div data-v-828910c6><h3 data-v-828910c6>69</h3> <h6 data-v-828910c6>Tags</h6></div></div> <ul class="social-links" data-v-828910c6></ul> <hr data-v-828910c6></div> <nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link"><i class="iconfont reco-home"></i>
  主页
</a></div><div class="nav-item"><a href="/ml/" class="nav-link"><i class="fa fa-laptop-code"></i>
  机器学习
</a></div><div class="nav-item"><a href="/recommend-system/" class="nav-link router-link-active"><i class="fa fa-assistive-listening-systems"></i>
  推荐系统
</a></div><div class="nav-item"><a href="/nlp/" class="nav-link"><i class="fa fa-language"></i>
  自然语言处理
</a></div><div class="nav-item"><a href="/leetcode/" class="nav-link"><i class="fa fa-file-code"></i>
  Leetcode
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-message"></i>
      Contact
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://mp.weixin.qq.com/s/tddJF6sPAsDf1psqwfXHlg" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont reco-wechat"></i>
  公众号
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://www.zhihu.com/people/zhang-hua-28-4" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont reco-zhihu"></i>
  知乎
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav> <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>一、推荐系统概览</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/recommend-system/1.1.html" class="sidebar-link">1.1-概览</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>二、特征工程</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/recommend-system/2.1.html" class="sidebar-link">2.1-特征提取</a></li><li><a href="/recommend-system/2.2.html" class="sidebar-link">2.2-处理数值特征</a></li><li><a href="/recommend-system/2.3.html" class="sidebar-link">2.3-处理类别特征</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>三、Embedding</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/recommend-system/3.1.html" class="sidebar-link">3.1-Embedding介绍</a></li><li><a href="/recommend-system/3.2.html" class="sidebar-link">3.2-Embedding的共享与独占</a></li><li><a href="/recommend-system/3.3.html" class="sidebar-link">3.3-参数服务器</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>四、精排</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/recommend-system/4.1.html" class="sidebar-link">4.1-交叉结构</a></li><li><a href="/recommend-system/4.2.html" class="sidebar-link">4.2-Transformer</a></li><li><a href="/recommend-system/4.3.html" class="sidebar-link">4.3-用户行为序列建模</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>五、召回</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/recommend-system/5.1.html" class="sidebar-link">5.1-传统召回</a></li><li><a href="/recommend-system/5.2.html" aria-current="page" class="active sidebar-link">5.2-向量化召回</a></li><li><a href="/recommend-system/5.3.html" class="sidebar-link">5.3-FM召回</a></li><li><a href="/recommend-system/5.4.html" class="sidebar-link">5.4-双塔召回</a></li><li><a href="/recommend-system/5.5.html" class="sidebar-link">5.5-GCN召回</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>六、粗排与重排</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/recommend-system/6.1.html" class="sidebar-link">6.1-粗排</a></li><li><a href="/recommend-system/6.2.html" class="sidebar-link">6.2-重排</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>七、多目标与多场景</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/recommend-system/7.1.html" class="sidebar-link">7.1-多目标</a></li><li><a href="/recommend-system/7.2.html" class="sidebar-link">7.2-多场景</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>八、冷启动</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/recommend-system/8.1.html" class="sidebar-link">8.1-</a></li><li><a href="/recommend-system/8.2.html" class="sidebar-link">8.2-对比学习</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>九、评估与调试</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/recommend-system/9.1.html" class="sidebar-link">9.1-离线评估</a></li><li><a href="/recommend-system/9.2.html" class="sidebar-link">9.2-在线评估</a></li><li><a href="/recommend-system/9.3.html" class="sidebar-link">9.3-线上线下一致性</a></li></ul></section></li></ul> </aside> <div class="password-shadow password-wrapper-in" style="display:none;" data-v-4e82dffc data-v-1156296a><h3 class="title" data-v-4e82dffc data-v-4e82dffc>5.2-向量化召回</h3> <!----> <label id="box" class="inputBox" data-v-4e82dffc data-v-4e82dffc><input type="password" value="" data-v-4e82dffc> <span data-v-4e82dffc>Konck! Knock!</span> <button data-v-4e82dffc>OK</button></label> <div class="footer" data-v-4e82dffc data-v-4e82dffc><span data-v-4e82dffc><i class="iconfont reco-theme" data-v-4e82dffc></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-4e82dffc>vuePress-theme-reco</a></span> <span data-v-4e82dffc><i class="iconfont reco-copyright" data-v-4e82dffc></i> <a data-v-4e82dffc><span data-v-4e82dffc>阿药</span>
            
          <span data-v-4e82dffc>2021 - </span>
          2023
        </a></span></div></div> <div data-v-1156296a><main class="page" style="padding-right:0;"><section><div class="page-title"><h1 class="title">5.2-向量化召回</h1> <div data-v-1ff7123e><i class="iconfont reco-account" data-v-1ff7123e><span data-v-1ff7123e>阿药</span></i> <i class="iconfont reco-date" data-v-1ff7123e><span data-v-1ff7123e>8/2/2021</span></i> <i class="iconfont reco-eye" data-v-1ff7123e><span id="/recommend-system/5.2.html" data-flag-title="Your Article Title" class="leancloud-visitors" data-v-1ff7123e><a class="leancloud-visitors-count" style="font-size:.9rem;font-weight:normal;color:#999;"></a></span></i> <!----></div></div> <div class="theme-reco-content content__default"><p><img src="https://cdn.nlark.com/yuque/0/2023/png/13009966/1689073763248-181f9a90-ad3e-448f-a122-e4bd61e925ef.png#averageHue=%23282c3e&amp;clientId=uba78a190-3701-4&amp;from=paste&amp;height=775&amp;id=ue76d56c0&amp;originHeight=775&amp;originWidth=1231&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=232790&amp;status=done&amp;style=none&amp;taskId=u03df23c5-fde0-4d40-9302-9ad8ed74a90&amp;title=&amp;width=1231" alt="image.png"></p> <h3 id="请简述向量化召回的基本链路-如何统一的建模框架来解释向量化召回"><a href="#请简述向量化召回的基本链路-如何统一的建模框架来解释向量化召回" class="header-anchor">#</a> 请简述向量化召回的基本链路，如何统一的建模框架来解释向量化召回？</h3> <p>所谓向量化召回，就是将召回问题，建模成向量空间内的近邻搜索问题。假设召回问题中包含两类实体Q和T</p> <ul><li>如果Q是用户，T是物料，给用户直接找他喜欢的物料，就是user-to-item召回（简称U2I）；</li> <li>如果Q和T都是物料，那就是item-to-item召回（简称I2I），用于给用户找与他喜欢的物料相似的其他物料，比如&quot;看了又看&quot;场景；</li> <li>如果Q和T都是用户，那就是user-to-user-to-item召回（简称U2U2I），先给当前用户查找与他相似的用户，再把相似用户喜欢的东西推荐给当前用户。</li></ul> <p>向量化召回的基本套路如下：</p> <ul><li>第一步，训练一个模型<mjx-container jax="CHTML" class="MathJax"><mjx-math class=" MJX-TEX"><mjx-mi class="mjx-i"><mjx-c c="M"></mjx-c></mjx-mi></mjx-math></mjx-container>，将<mjx-container jax="CHTML" class="MathJax"><mjx-math class=" MJX-TEX"><mjx-mi class="mjx-i"><mjx-c c="Q"></mjx-c></mjx-mi></mjx-math></mjx-container>中的每个实例<mjx-container jax="CHTML" class="MathJax"><mjx-math class=" MJX-TEX"><mjx-mi class="mjx-i"><mjx-c c="q"></mjx-c></mjx-mi></mjx-math></mjx-container>，和<mjx-container jax="CHTML" class="MathJax"><mjx-math class=" MJX-TEX"><mjx-mi class="mjx-i"><mjx-c c="T"></mjx-c></mjx-mi></mjx-math></mjx-container>中的每个实例<mjx-container jax="CHTML" class="MathJax"><mjx-math class=" MJX-TEX"><mjx-mi class="mjx-i"><mjx-c c="t"></mjx-c></mjx-mi></mjx-math></mjx-container>，都映射到同一个向量空间。</li> <li>第二步，将<mjx-container jax="CHTML" class="MathJax"><mjx-math class=" MJX-TEX"><mjx-mi class="mjx-i"><mjx-c c="T"></mjx-c></mjx-mi></mjx-math></mjx-container>中几十万、上百万个实例，喂入模型<mjx-container jax="CHTML" class="MathJax"><mjx-math class=" MJX-TEX"><mjx-mi class="mjx-i"><mjx-c c="M"></mjx-c></mjx-mi></mjx-math></mjx-container>，映射成向量。再把这几十万、上百万个向量灌入<mjx-container jax="CHTML" class="MathJax"><mjx-math class=" MJX-TEX"><mjx-mi class="mjx-i"><mjx-c c="F"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c c="A"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c c="I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c c="S"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c c="S"></mjx-c></mjx-mi></mjx-math></mjx-container>或<mjx-container jax="CHTML" class="MathJax"><mjx-math class=" MJX-TEX"><mjx-mi class="mjx-i"><mjx-c c="M"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c c="i"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c c="l"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c c="v"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c c="u"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c c="s"></mjx-c></mjx-mi></mjx-math></mjx-container>这样的向量数据库，建立索引。</li> <li>第三步，在线服务时，来了一个<mjx-container jax="CHTML" class="MathJax"><mjx-math class=" MJX-TEX"><mjx-mi class="mjx-i"><mjx-c c="Q"></mjx-c></mjx-mi></mjx-math></mjx-container>类的实例<mjx-container jax="CHTML" class="MathJax"><mjx-math class=" MJX-TEX"><mjx-mi class="mjx-i"><mjx-c c="q"></mjx-c></mjx-mi></mjx-math></mjx-container>，通过模型<mjx-container jax="CHTML" class="MathJax"><mjx-math class=" MJX-TEX"><mjx-mi class="mjx-i"><mjx-c c="M"></mjx-c></mjx-mi></mjx-math></mjx-container>将其映射成向量<mjx-container jax="CHTML" class="MathJax"><mjx-math class=" MJX-TEX"><mjx-mi class="mjx-i"><mjx-c c="E"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c c="m"></mjx-c></mjx-mi><mjx-msub><mjx-mi noIC="true" class="mjx-i"><mjx-c c="b"></mjx-c></mjx-mi><mjx-script style="vertical-align:-0.15em;"><mjx-mi size="s" class="mjx-i"><mjx-c c="q"></mjx-c></mjx-mi></mjx-script></mjx-msub></mjx-math></mjx-container>。再在向量数据库中，通过近似近邻搜索 （Approximate Nearest Neighbors，ANN）算法，查找与<mjx-container jax="CHTML" class="MathJax"><mjx-math class=" MJX-TEX"><mjx-mi class="mjx-i"><mjx-c c="E"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c c="m"></mjx-c></mjx-mi><mjx-msub><mjx-mi noIC="true" class="mjx-i"><mjx-c c="b"></mjx-c></mjx-mi><mjx-script style="vertical-align:-0.15em;"><mjx-mi size="s" class="mjx-i"><mjx-c c="q"></mjx-c></mjx-mi></mjx-script></mjx-msub></mjx-math></mjx-container>最近的<mjx-container jax="CHTML" class="MathJax"><mjx-math class=" MJX-TEX"><mjx-mi class="mjx-i"><mjx-c c="K"></mjx-c></mjx-mi></mjx-math></mjx-container>个<mjx-container jax="CHTML" class="MathJax"><mjx-math class=" MJX-TEX"><mjx-mi class="mjx-i"><mjx-c c="T"></mjx-c></mjx-mi></mjx-math></mjx-container>类的邻居向量<mjx-container jax="CHTML" class="MathJax"><mjx-math class=" MJX-TEX"><mjx-mi class="mjx-i"><mjx-c c="E"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c c="m"></mjx-c></mjx-mi><mjx-msub><mjx-mi noIC="true" class="mjx-i"><mjx-c c="b"></mjx-c></mjx-mi><mjx-script style="vertical-align:-0.15em;"><mjx-TeXAtom size="s"><mjx-msub><mjx-mi noIC="true" class="mjx-i"><mjx-c c="t"></mjx-c></mjx-mi><mjx-script style="vertical-align:-0.15em;"><mjx-mi size="s" class="mjx-i"><mjx-c c="i"></mjx-c></mjx-mi></mjx-script></mjx-msub></mjx-TeXAtom></mjx-script></mjx-msub></mjx-math></mjx-container>。这些邻居向量对应的<mjx-container jax="CHTML" class="MathJax"><mjx-math class=" MJX-TEX"><mjx-msub><mjx-mi noIC="true" class="mjx-i"><mjx-c c="t"></mjx-c></mjx-mi><mjx-script style="vertical-align:-0.15em;"><mjx-mi size="s" class="mjx-i"><mjx-c c="i"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c c="("></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c c="1"></mjx-c></mjx-mn><mjx-mo space="4" class="mjx-n"><mjx-c c="2264"></mjx-c></mjx-mo><mjx-mi space="4" class="mjx-i"><mjx-c c="i"></mjx-c></mjx-mi><mjx-mo space="4" class="mjx-n"><mjx-c c="2264"></mjx-c></mjx-mo><mjx-mi space="4" class="mjx-i"><mjx-c c="K"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c c=")"></mjx-c></mjx-mo></mjx-math></mjx-container>，作为召回结果返回。</li></ul> <p>向量化召回不是单指某一个具体的算法，而是一个庞大的家族，比如：Item2Vec、Youtube的召回算法、Airbnb的召回算法、FM召回、微软的DSSM、双塔模型、百度的李生网络、阿里的EGES、Pinterest的PinSage、腾讯的GraphTR等。这些向量化召回算法，从召回方式上分，涵盖了U21、I21、U2U21三大类；从算法实现上分，有的来自&quot;前DNN&quot;时代，有的基于深度学习，还有的基于图算法；从优化目标上分，有的是按照多分类问题来求解，有的基于Learning-To-Rank（LTR）思路来优化。</p> <p>向量化召回算法，其实都可以用一套统一的建模框架所囊括。统一建模框架由4个维度构成：</p> <ol><li>如何定义正样本，即哪些<mjx-container jax="CHTML" class="MathJax"><mjx-math class=" MJX-TEX"><mjx-mi class="mjx-i"><mjx-c c="q"></mjx-c></mjx-mi></mjx-math></mjx-container>和<mjx-container jax="CHTML" class="MathJax"><mjx-math class=" MJX-TEX"><mjx-mi class="mjx-i"><mjx-c c="t"></mjx-c></mjx-mi></mjx-math></mjx-container>在向量空间内应该相近；</li> <li>如何定义负样本，即哪些<mjx-container jax="CHTML" class="MathJax"><mjx-math class=" MJX-TEX"><mjx-mi class="mjx-i"><mjx-c c="q"></mjx-c></mjx-mi></mjx-math></mjx-container>和<mjx-container jax="CHTML" class="MathJax"><mjx-math class=" MJX-TEX"><mjx-mi class="mjx-i"><mjx-c c="t"></mjx-c></mjx-mi></mjx-math></mjx-container>在向量空间内应该较远；</li> <li>如何将<mjx-container jax="CHTML" class="MathJax"><mjx-math class=" MJX-TEX"><mjx-mi class="mjx-i"><mjx-c c="q"></mjx-c></mjx-mi></mjx-math></mjx-container>和<mjx-container jax="CHTML" class="MathJax"><mjx-math class=" MJX-TEX"><mjx-mi class="mjx-i"><mjx-c c="t"></mjx-c></mjx-mi></mjx-math></mjx-container>映射成Embedding；</li> <li>如何定义优化目标，即如何制定损失函数；</li></ol> <h3 id="如何定义向量化召回中的正样本"><a href="#如何定义向量化召回中的正样本" class="header-anchor">#</a> 如何定义向量化召回中的正样本？</h3> <p>正样本的定义，即哪些q和的向量表示应该相近，取决于不同的召回场景：</p> <ul><li>I2I召回：q和t都是物料。比如我们认为同一个用户在同一个会话&quot;（Session，彼此间隔时间较短的用户行为序列）交互过（e.g.，点击、观看、购买等）的两个物料，在向量空间是相近的。这体现的是，两个物料之间的&quot;相似性&quot;；</li> <li>U2I召回：q是用户，t是物料。一个用户与其交互过的物料，在向量空间中，应该是相近的。这体现的是，用户与物料之间的&quot;匹配性&quot;。</li> <li>U2U召回：q和t都是用户。比如使用孪生网络，q是用户一半的交互历史，t是同一用户另一半交互历史，二者在向量空间应该是相近的，体现&quot;同一性&quot;。</li></ul> <h3 id="为什么不能只拿-曝光未点击-做召回模型的负样本"><a href="#为什么不能只拿-曝光未点击-做召回模型的负样本" class="header-anchor">#</a> 为什么不能只拿&quot;曝光未点击&quot;做召回模型的负样本？</h3> <p>召回是将用户可能喜欢的item，和用户根本不感兴趣的海量item分离开来，他面临的数据环境相对于排序来说是鱼龙混杂的。机器学习的一条最最基本的原则铁律，就是&quot;离线训练时的数据分布，应该与线上服务时的数据分布，保持一致”。<br>所以我们希望召回训练数据的正样本是user和item匹配度最高的那些样本，也即用户点击样本，负样本是user和item最不匹配的那些样本，但不能拿“曝光未点击”作为召回模型的负样本，这牵扯到推荐系统里常见的&quot;样本选择偏差&quot;（Sample Selection Bias，SSB）问题，因为我们从线上日志获得的训练样本，已经是上一版本的召回、粗排、精排替用户筛选过的，即已经是对用户“匹配度较高”的样本了，即推荐系统以为用户会喜欢他们，但用户的行为又表明的对他的嫌弃。拿这样的样本训练出来的模型做召回，并不能与线上环境的数据分布保持一致。也就是说曝光未点击既不能成为合格的正样本，也不能成为合格的负样本。<br>因此，为了让模型&quot;开眼界、见世面&quot;，喂给召回模型的负样本，主要依靠随机采样生成。特别是在U21召回场景中，坚决不能（只）拿&quot;曝光未点击&quot;当负样本。<br>召回模型的负样本全部由&quot;曝光未点击&quot;组成是绝对不行的。但是，&quot;以随机负采样为主，以曝光未点击为辅&quot;的混合方案，能否行得通？业界尚无定论。以业界的经验，都认为&quot;曝光未点击&quot;样本就是&quot;鸡肋&quot;，于召回模型无益。而在另外一些实践中，认为&quot;曝光未点击&quot;是Hard Negative，能够提升模型对细节的分辨能力。在随机负采样之外，加入&quot;曝光未点击&quot;能否提升召回性能？可以具体在工作场景中亲自实践一下。<br>如果说排序是特征的艺术，那么召回就是样本的艺术，特别是负样本的艺术。做召回，&quot;负样本为王”，负样本的选择对于算法成败是决定性的：选对了，你就稳过及格线；选错了，之后的特征工程、模型设计、推理优化都是南辕北辙，无本之木，平添无用功罢了。</p> <h3 id="随机负采样在实践中有哪些讲究"><a href="#随机负采样在实践中有哪些讲究" class="header-anchor">#</a> 随机负采样在实践中有哪些讲究？</h3> <p>只通过随机采样获得负样本，可能导致模型的精度不足。举个例子，假如你要训练一个“相似图片召回&quot;算法。当q是一只狗时，正例+是另外一只狗。负例t，在所有动物图片中随机采样得到，大概率是抽到猫、大象、乌鸦、海豚等图片。这些随机负样本，能够让模型&quot;大开眼界”，从而快速&quot;去伪存真&quot;。但是猫、大象、乌鸦、海豚等随机负例，都与正例（另一只狗）相差太大，使模型觉得只要能分辨粗粒度差异就足够了，没有动力去注意细节。这些负样本被称为Easy Negative。<br>因此，我们要为&quot;q=狗，t+=另一只狗&quot;配备一些狼、狐狸的图片做负例。这些负例称为Hard Negative，它们与正例还有几分相似，能给模型增加难度，迫使其关注细节。<br>需要特别强调的是，Hard negative：并非要替代随机采样得到的Easy Negative，而是作为Easy Negative的补充。在数量上，负样本还是应该以Easy Negative为主，Facebook的经验A是将比例维持在Easy：Hard=100：1。毕竟线上召回时，候选集中绝大多数的物料都是与用户八杆子打不着的，保证Easy Negative的数量优势，才能Hold住召回模型的及格线。</p> <h3 id="为什么排序鼓励交叉-而召回要求解耦呢"><a href="#为什么排序鼓励交叉-而召回要求解耦呢" class="header-anchor">#</a> 为什么排序鼓励交叉？而召回要求解耦呢？</h3> <p>排序鼓励交叉:</p> <ul><li>特征上，排序除了单独使用用户和物料特征，最重要还使用了大量的交叉统计特征，比如&quot;用户标签与物料标签的重合度”。这类交叉统计特征是衡量&quot;用户物料匹配程度&quot;的最强信号，但是它们无法离线事先计算好，服务于所有用户请求。</li> <li>模型上，排序一般将用户特征、物料特征、交叉统计特征拼接成一个大向量，喂入DNN，让三类特征层层交叉。从第一个全链接层（Fully Connection，FC）之后，你就已经无法分辨，它输出的向量中，哪几位属于用户信息？哪几位属于物料信息？</li></ul> <p>排序之所以允许、鼓励交叉，还是因为它的候选集比较小，最多不过一两千个。</p> <p>召回要求解耦：<br>换成召回那样，要面对十万、百万级别的海量候选物料，如果让每个用户与每个候选物料都计算交叉统计特征，都过一遍DNN那样的复杂运算，是无论如何也无法满足线上的实时性要求的。<br>所以，召回必须解耦、隔离用户信息与物料信息：</p> <ul><li>特征上，召回无法使用，用户物料之间的交叉统计特征（比如：用户标签与物料标签之间的重合度）。</li> <li>模型上，召回不能将用户特征、物料特征一古脑扔进DNN，两者必须独立发展。用户子模型，只利用用户特征，生成用户向量<mjx-container jax="CHTML" class="MathJax"><mjx-math class=" MJX-TEX"><mjx-mi class="mjx-i"><mjx-c c="E"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c c="m"></mjx-c></mjx-mi><mjx-msub><mjx-mi noIC="true" class="mjx-i"><mjx-c c="b"></mjx-c></mjx-mi><mjx-script style="vertical-align:-0.15em;"><mjx-TeXAtom size="s"><mjx-mi class="mjx-i"><mjx-c c="u"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c c="s"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c c="e"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c c="r"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-script></mjx-msub></mjx-math></mjx-container>。物料子模型，只利用物料特征，生成物料向量<mjx-container jax="CHTML" class="MathJax"><mjx-math class=" MJX-TEX"><mjx-mi class="mjx-i"><mjx-c c="E"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c c="m"></mjx-c></mjx-mi><mjx-msub><mjx-mi noIC="true" class="mjx-i"><mjx-c c="b"></mjx-c></mjx-mi><mjx-script style="vertical-align:-0.15em;"><mjx-TeXAtom size="s"><mjx-mi class="mjx-i"><mjx-c c="i"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c c="t"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c c="e"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c c="m"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-script></mjx-msub></mjx-math></mjx-container>。只允许最后计算<mjx-container jax="CHTML" class="MathJax"><mjx-math class=" MJX-TEX"><mjx-mi class="mjx-i"><mjx-c c="E"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c c="m"></mjx-c></mjx-mi><mjx-msub><mjx-mi noIC="true" class="mjx-i"><mjx-c c="b"></mjx-c></mjx-mi><mjx-script style="vertical-align:-0.15em;"><mjx-TeXAtom size="s"><mjx-mi class="mjx-i"><mjx-c c="u"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c c="s"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c c="e"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c c="r"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-script></mjx-msub><mjx-mo space="3" class="mjx-n"><mjx-c c="B7"></mjx-c></mjx-mo><mjx-mi space="3" class="mjx-i"><mjx-c c="E"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c c="m"></mjx-c></mjx-mi><mjx-msub><mjx-mi noIC="true" class="mjx-i"><mjx-c c="b"></mjx-c></mjx-mi><mjx-script style="vertical-align:-0.15em;"><mjx-TeXAtom size="s"><mjx-mi class="mjx-i"><mjx-c c="i"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c c="t"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c c="e"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c c="m"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-script></mjx-msub></mjx-math></mjx-container>或<mjx-container jax="CHTML" class="MathJax"><mjx-math class=" MJX-TEX"><mjx-mi class="mjx-i"><mjx-c c="c"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c c="o"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c c="s"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c c="i"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c c="n"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c c="e"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c c="("></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c c="E"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c c="m"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c c="b"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c c="u"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c c="s"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c c="e"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c c="r"></mjx-c></mjx-mi><mjx-mo space="4" class="mjx-n"><mjx-utext variant="normal" style="font-family:serif;">，</mjx-utext></mjx-mo><mjx-mi space="4" class="mjx-i"><mjx-c c="E"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c c="m"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c c="b"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c c="i"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c c="t"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c c="e"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c c="m"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c c=")"></mjx-c></mjx-mo></mjx-math></mjx-container>时，才产生用户信息与物料信息的唯一次交叉。</li></ul> <p>这样解耦的目的</p> <ul><li>离线时，不必知道是哪个用户发出请求，提前计算好生成百万、千万量级的物料向量（<mjx-container jax="CHTML" class="MathJax"><mjx-math class=" MJX-TEX"><mjx-mi class="mjx-i"><mjx-c c="i"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c c="."></mjx-c></mjx-mo><mjx-mi space="2" class="mjx-i"><mjx-c c="e"></mjx-c></mjx-mi><mjx-mo space="4" class="mjx-n"><mjx-utext variant="normal" style="font-family:serif;">，</mjx-utext></mjx-mo><mjx-mi space="4" class="mjx-i"><mjx-c c="E"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c c="m"></mjx-c></mjx-mi><mjx-msub><mjx-mi noIC="true" class="mjx-i"><mjx-c c="b"></mjx-c></mjx-mi><mjx-script style="vertical-align:-0.15em;"><mjx-TeXAtom size="s"><mjx-mi class="mjx-i"><mjx-c c="i"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c c="t"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c c="e"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c c="m"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-script></mjx-msub></mjx-math></mjx-container>），灌入FAISS并建立好索引；</li> <li>在线时，独立生成用户向量（<mjx-container jax="CHTML" class="MathJax"><mjx-math class=" MJX-TEX"><mjx-mi class="mjx-i"><mjx-c c="i"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c c="."></mjx-c></mjx-mo><mjx-mi space="2" class="mjx-i"><mjx-c c="e"></mjx-c></mjx-mi><mjx-mo space="4" class="mjx-n"><mjx-utext variant="normal" style="font-family:serif;">，</mjx-utext></mjx-mo><mjx-mi space="4" class="mjx-i"><mjx-c c="E"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c c="m"></mjx-c></mjx-mi><mjx-msub><mjx-mi noIC="true" class="mjx-i"><mjx-c c="b"></mjx-c></mjx-mi><mjx-script style="vertical-align:-0.15em;"><mjx-TeXAtom size="s"><mjx-mi class="mjx-i"><mjx-c c="u"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c c="s"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c c="e"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c c="r"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-script></mjx-msub></mjx-math></mjx-container>），去FAISS里利用近似近邻搜索算法（ANN），快速搜索出与<mjx-container jax="CHTML" class="MathJax"><mjx-math class=" MJX-TEX"><mjx-mi class="mjx-i"><mjx-c c="E"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c c="m"></mjx-c></mjx-mi><mjx-msub><mjx-mi noIC="true" class="mjx-i"><mjx-c c="b"></mjx-c></mjx-mi><mjx-script style="vertical-align:-0.15em;"><mjx-TeXAtom size="s"><mjx-mi class="mjx-i"><mjx-c c="u"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c c="s"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c c="e"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c c="r"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-script></mjx-msub></mjx-math></mjx-container>接近的<mjx-container jax="CHTML" class="MathJax"><mjx-math class=" MJX-TEX"><mjx-mi class="mjx-i"><mjx-c c="E"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c c="m"></mjx-c></mjx-mi><mjx-msub><mjx-mi noIC="true" class="mjx-i"><mjx-c c="b"></mjx-c></mjx-mi><mjx-script style="vertical-align:-0.15em;"><mjx-TeXAtom size="s"><mjx-mi class="mjx-i"><mjx-c c="i"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c c="t"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c c="e"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c c="m"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-script></mjx-msub></mjx-math></mjx-container>。避免让每个用户与几百万、上千万的候选物料，逐一进行&quot;计算交叉特征&quot;和&quot;通过DNN&quot;这样复杂耗时的操作。</li></ul> <h3 id="召回和精排在定义损失函数上有什么不同"><a href="#召回和精排在定义损失函数上有什么不同" class="header-anchor">#</a> 召回和精排在定义损失函数上有什么不同？</h3> <p>如何定义损失函数，召回与精排有很大不同。精排追求的预测值的&quot;绝对准确性&quot;，它使用BinaryCross--Entropy Loss，力图将每条样本的CTR/CVR预测得越准越好。这是因为：</p> <ul><li>精排的候选集小，而且每个负样本都来自用户的真实反馈，因此精排有条件把每个负样本的CTR/CVR都预测准确。</li> <li>精排打分的准确性，是下游任务（比如广告计费、打散重排等）成败的关键。因此，如果精排打分只能保证“将用户喜欢的排在前面&quot;的&quot;相对准确性&quot;，那是远远不够的。</li></ul> <p>而召回的优化目标、损失函数主要考虑的是排序的&quot;相对准确性&quot;</p> <ul><li>召回的候选集非常庞大，而且只有正样本来自用户真实反馈，而负样本往往都未曾向用户曝光过，所以召回没条件对负样本要求预测值绝对准确。召回常用的一类损失函数是多分类的Softmax Loss，只要求把正样本的概率预测得越高越好。</li> <li>召回的作用是筛选候选集，只要能把用户喜欢的排在前面就好。因此，召回中另一类常用的损失函数遵循Learning-To-Rank（LTR）思想，不求预估值的绝对准确，只追求排序的相对准确性。</li></ul> <h3 id="nce-loss的基本思想与计算公式"><a href="#nce-loss的基本思想与计算公式" class="header-anchor">#</a> NCE Loss的基本思想与计算公式</h3> <h3 id="neg-loss的基本思想与计算公式-它与nce-loss是什么关系"><a href="#neg-loss的基本思想与计算公式-它与nce-loss是什么关系" class="header-anchor">#</a> NEG Loss的基本思想与计算公式？它与NCE Loss是什么关系？</h3> <h3 id="marginal-hinge-loss的基本思想与计算公式"><a href="#marginal-hinge-loss的基本思想与计算公式" class="header-anchor">#</a> Marginal Hinge Loss的基本思想与计算公式</h3> <h3 id="bpr-loss的基本思想与计算公式"><a href="#bpr-loss的基本思想与计算公式" class="header-anchor">#</a> BPR Loss的基本思想与计算公式</h3> <h3 id="sampled-softmax的基本思想与计算公式"><a href="#sampled-softmax的基本思想与计算公式" class="header-anchor">#</a> Sampled Softmax的基本思想与计算公式</h3> <h3 id="sampled-softmax中温度修正的作用-调高温度什么影响-调低温度有什么影响"><a href="#sampled-softmax中温度修正的作用-调高温度什么影响-调低温度有什么影响" class="header-anchor">#</a> Sampled Softmax中温度修正的作用？调高温度什么影响？调低温度有什么影响？</h3> <p><mjx-container jax="CHTML" class="MathJax"><mjx-math class=" MJX-TEX"><mjx-mi class="mjx-i"><mjx-c c="G"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c c="("></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c c="u"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c c=","></mjx-c></mjx-mo><mjx-mi space="2" class="mjx-i"><mjx-c c="t"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c c=")"></mjx-c></mjx-mo><mjx-mo space="4" class="mjx-n"><mjx-c c="="></mjx-c></mjx-mo><mjx-mfrac space="4"><mjx-frac><mjx-num><mjx-nstrut></mjx-nstrut><mjx-mrow size="s"><mjx-mi class="mjx-i"><mjx-c c="u"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c c="B7"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c c="t"></mjx-c></mjx-mi></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line></mjx-line><mjx-row><mjx-den><mjx-dstrut></mjx-dstrut><mjx-mi size="s" class="mjx-i"><mjx-c c="3C4"></mjx-c></mjx-mi></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-mo space="3" class="mjx-n"><mjx-c c="2212"></mjx-c></mjx-mo><mjx-mi space="3" class="mjx-i"><mjx-c c="l"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c c="o"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c c="g"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c c="Q"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c c="("></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c c="t"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c c=")"></mjx-c></mjx-mo></mjx-math></mjx-container><br><mjx-container jax="CHTML" class="MathJax"><mjx-math class=" MJX-TEX"><mjx-msub><mjx-mi noIC="true" class="mjx-i"><mjx-c c="L"></mjx-c></mjx-mi><mjx-script style="vertical-align:-0.15em;"><mjx-TeXAtom size="s"><mjx-mi class="mjx-i"><mjx-c c="T"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c c="o"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c c="w"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c c="e"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c c="r"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-script></mjx-msub><mjx-mo space="4" class="mjx-n"><mjx-c c="="></mjx-c></mjx-mo><mjx-mo space="4" class="mjx-n"><mjx-c c="2212"></mjx-c></mjx-mo><mjx-mfrac><mjx-frac><mjx-num><mjx-nstrut></mjx-nstrut><mjx-mn size="s" class="mjx-n"><mjx-c c="1"></mjx-c></mjx-mn></mjx-num><mjx-dbox><mjx-dtable><mjx-line></mjx-line><mjx-row><mjx-den><mjx-dstrut></mjx-dstrut><mjx-mrow size="s"><mjx-mo class="mjx-n"><mjx-c c="|"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c c="B"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c c="|"></mjx-c></mjx-mo></mjx-mrow></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-munder space="2" limits="false"><mjx-mo class="mjx-sop"><mjx-c c="2211"></mjx-c></mjx-mo><mjx-script style="vertical-align:-0.285em;"><mjx-TeXAtom size="s"><mjx-mo class="mjx-n"><mjx-c c="("></mjx-c></mjx-mo><mjx-msub><mjx-mi noIC="true" class="mjx-i"><mjx-c c="u"></mjx-c></mjx-mi><mjx-script style="vertical-align:-0.15em;"><mjx-mi size="s" class="mjx-i"><mjx-c c="i"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c c=","></mjx-c></mjx-mo><mjx-msub><mjx-mi noIC="true" class="mjx-i"><mjx-c c="t"></mjx-c></mjx-mi><mjx-script style="vertical-align:-0.15em;"><mjx-mi size="s" class="mjx-i"><mjx-c c="i"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c c=")"></mjx-c></mjx-mo><mjx-mo class="mjx-n"><mjx-c c="2208"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c c="B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-script></mjx-munder><mjx-mi space="2" class="mjx-i"><mjx-c c="l"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c c="o"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c c="g"></mjx-c></mjx-mi><mjx-mfrac><mjx-frac><mjx-num><mjx-nstrut></mjx-nstrut><mjx-mrow size="s"><mjx-mi class="mjx-i"><mjx-c c="e"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c c="x"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c c="p"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c c="("></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c c="G"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c c="("></mjx-c></mjx-mo><mjx-msub><mjx-mi noIC="true" class="mjx-i"><mjx-c c="u"></mjx-c></mjx-mi><mjx-script style="vertical-align:-0.15em;"><mjx-mi size="s" class="mjx-i"><mjx-c c="i"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c c=","></mjx-c></mjx-mo><mjx-msub><mjx-mi noIC="true" class="mjx-i"><mjx-c c="t"></mjx-c></mjx-mi><mjx-script style="vertical-align:-0.15em;"><mjx-mi size="s" class="mjx-i"><mjx-c c="i"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c c=")"></mjx-c></mjx-mo><mjx-mo class="mjx-n"><mjx-c c=")"></mjx-c></mjx-mo></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line></mjx-line><mjx-row><mjx-den><mjx-dstrut></mjx-dstrut><mjx-mrow size="s"><mjx-mi class="mjx-i"><mjx-c c="e"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c c="x"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c c="p"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c c="("></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c c="G"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c c="("></mjx-c></mjx-mo><mjx-msub><mjx-mi noIC="true" class="mjx-i"><mjx-c c="u"></mjx-c></mjx-mi><mjx-script style="vertical-align:-0.15em;"><mjx-mi size="s" class="mjx-i"><mjx-c c="i"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c c=","></mjx-c></mjx-mo><mjx-msub><mjx-mi noIC="true" class="mjx-i"><mjx-c c="t"></mjx-c></mjx-mi><mjx-script style="vertical-align:-0.15em;"><mjx-mi size="s" class="mjx-i"><mjx-c c="i"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c c=")"></mjx-c></mjx-mo><mjx-mo class="mjx-n"><mjx-c c=")"></mjx-c></mjx-mo><mjx-mo class="mjx-n"><mjx-c c="+"></mjx-c></mjx-mo><mjx-munder limits="false"><mjx-mo class="mjx-sop"><mjx-c c="2211"></mjx-c></mjx-mo><mjx-script style="vertical-align:-0.285em;"><mjx-TeXAtom size="s"><mjx-mi class="mjx-i"><mjx-c c="j"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c c="2208"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c c="B"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c c=","></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c c="j"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c c="2260"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c c="i"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-script></mjx-munder><mjx-mi space="2" class="mjx-i"><mjx-c c="e"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c c="x"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c c="p"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c c="("></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c c="G"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c c="("></mjx-c></mjx-mo><mjx-msub><mjx-mi noIC="true" class="mjx-i"><mjx-c c="u"></mjx-c></mjx-mi><mjx-script style="vertical-align:-0.15em;"><mjx-mi size="s" class="mjx-i"><mjx-c c="i"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c c=","></mjx-c></mjx-mo><mjx-msub><mjx-mi noIC="true" class="mjx-i"><mjx-c c="t"></mjx-c></mjx-mi><mjx-script style="vertical-align:-0.15em;"><mjx-mi size="s" class="mjx-i"><mjx-c c="j"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c c=")"></mjx-c></mjx-mo><mjx-mo class="mjx-n"><mjx-c c=")"></mjx-c></mjx-mo></mjx-mrow></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac></mjx-math></mjx-container><br>双塔模型损失函数中的温度调整系数<mjx-container jax="CHTML" class="MathJax"><mjx-math class=" MJX-TEX"><mjx-mi class="mjx-i"><mjx-c c="3C4"></mjx-c></mjx-mi></mjx-math></mjx-container>，<mjx-container jax="CHTML" class="MathJax"><mjx-math class=" MJX-TEX"><mjx-mn class="mjx-n"><mjx-c c="0"></mjx-c></mjx-mn><mjx-mo space="4" class="mjx-n"><mjx-c c="&lt;"></mjx-c></mjx-mo><mjx-mi space="4" class="mjx-i"><mjx-c c="3C4"></mjx-c></mjx-mi><mjx-mo space="4" class="mjx-n"><mjx-c c="&lt;"></mjx-c></mjx-mo><mjx-mn space="4" class="mjx-n"><mjx-c c="1"></mjx-c></mjx-mn></mjx-math></mjx-container>。我们知道Softmax Loss的优化目标是，使正例的概率<mjx-container jax="CHTML" class="MathJax"><mjx-math class=" MJX-TEX"><mjx-mi class="mjx-i"><mjx-c c="e"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c c="x"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c c="p"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c c="("></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c c="G"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c c="("></mjx-c></mjx-mo><mjx-msub><mjx-mi noIC="true" class="mjx-i"><mjx-c c="u"></mjx-c></mjx-mi><mjx-script style="vertical-align:-0.15em;"><mjx-mi size="s" class="mjx-i"><mjx-c c="i"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c c=","></mjx-c></mjx-mo><mjx-msub space="2"><mjx-mi noIC="true" class="mjx-i"><mjx-c c="t"></mjx-c></mjx-mi><mjx-script style="vertical-align:-0.15em;"><mjx-mi size="s" class="mjx-i"><mjx-c c="i"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c c=")"></mjx-c></mjx-mo><mjx-mo class="mjx-n"><mjx-c c=")"></mjx-c></mjx-mo><mjx-mo space="3" class="mjx-n"><mjx-c c="+"></mjx-c></mjx-mo><mjx-munder space="3" limits="false"><mjx-mo class="mjx-sop"><mjx-c c="2211"></mjx-c></mjx-mo><mjx-script style="vertical-align:-0.285em;"><mjx-TeXAtom size="s"><mjx-mi class="mjx-i"><mjx-c c="j"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c c="2208"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c c="B"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c c=","></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c c="j"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c c="2260"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c c="i"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-script></mjx-munder><mjx-mi space="2" class="mjx-i"><mjx-c c="e"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c c="x"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c c="p"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c c="("></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c c="G"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c c="("></mjx-c></mjx-mo><mjx-msub><mjx-mi noIC="true" class="mjx-i"><mjx-c c="u"></mjx-c></mjx-mi><mjx-script style="vertical-align:-0.15em;"><mjx-mi size="s" class="mjx-i"><mjx-c c="i"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c c=","></mjx-c></mjx-mo><mjx-msub space="2"><mjx-mi noIC="true" class="mjx-i"><mjx-c c="t"></mjx-c></mjx-mi><mjx-script style="vertical-align:-0.15em;"><mjx-mi size="s" class="mjx-i"><mjx-c c="j"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c c=")"></mjx-c></mjx-mo><mjx-mo class="mjx-n"><mjx-c c=")"></mjx-c></mjx-mo></mjx-math></mjx-container>尽可能大，这就要求分母中每个负例的得分<mjx-container jax="CHTML" class="MathJax"><mjx-math class=" MJX-TEX"><mjx-mi class="mjx-i"><mjx-c c="G"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c c="("></mjx-c></mjx-mo><mjx-msub><mjx-mi noIC="true" class="mjx-i"><mjx-c c="u"></mjx-c></mjx-mi><mjx-script style="vertical-align:-0.15em;"><mjx-mi size="s" class="mjx-i"><mjx-c c="i"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c c=","></mjx-c></mjx-mo><mjx-msub space="2"><mjx-mi noIC="true" class="mjx-i"><mjx-c c="t"></mjx-c></mjx-mi><mjx-script style="vertical-align:-0.15em;"><mjx-mi size="s" class="mjx-i"><mjx-c c="j"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c c=")"></mjx-c></mjx-mo></mjx-math></mjx-container>要尽可能小才行。所以<mjx-container jax="CHTML" class="MathJax"><mjx-math class=" MJX-TEX"><mjx-mi class="mjx-i"><mjx-c c="3C4"></mjx-c></mjx-mi></mjx-math></mjx-container>起到一个放大器的作用，但凡有哪些负例<mjx-container jax="CHTML" class="MathJax"><mjx-math class=" MJX-TEX"><mjx-msub><mjx-mi noIC="true" class="mjx-i"><mjx-c c="u"></mjx-c></mjx-mi><mjx-script style="vertical-align:-0.15em;"><mjx-mi size="s" class="mjx-i"><mjx-c c="i"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c c=","></mjx-c></mjx-mo><mjx-msub space="2"><mjx-mi noIC="true" class="mjx-i"><mjx-c c="t"></mjx-c></mjx-mi><mjx-script style="vertical-align:-0.15em;"><mjx-mi size="s" class="mjx-i"><mjx-c c="j"></mjx-c></mjx-mi></mjx-script></mjx-msub></mjx-math></mjx-container>没被训练好，导致<mjx-container jax="CHTML" class="MathJax"><mjx-math class=" MJX-TEX"><mjx-mi class="mjx-i"><mjx-c c="c"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c c="o"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c c="s"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c c="i"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c c="n"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c c="("></mjx-c></mjx-mo><mjx-msub><mjx-mi noIC="true" class="mjx-i"><mjx-c c="u"></mjx-c></mjx-mi><mjx-script style="vertical-align:-0.15em;"><mjx-mi size="s" class="mjx-i"><mjx-c c="i"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c c=","></mjx-c></mjx-mo><mjx-msub space="2"><mjx-mi noIC="true" class="mjx-i"><mjx-c c="t"></mjx-c></mjx-mi><mjx-script style="vertical-align:-0.15em;"><mjx-mi size="s" class="mjx-i"><mjx-c c="j"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c c=")"></mjx-c></mjx-mo><mjx-mo space="4" class="mjx-n"><mjx-c c="&gt;"></mjx-c></mjx-mo><mjx-mn space="4" class="mjx-n"><mjx-c c="0"></mjx-c></mjx-mn></mjx-math></mjx-container>,<mjx-container jax="CHTML" class="MathJax"><mjx-math class=" MJX-TEX"><mjx-mfrac><mjx-frac><mjx-num><mjx-nstrut></mjx-nstrut><mjx-mn size="s" class="mjx-n"><mjx-c c="1"></mjx-c></mjx-mn></mjx-num><mjx-dbox><mjx-dtable><mjx-line></mjx-line><mjx-row><mjx-den><mjx-dstrut></mjx-dstrut><mjx-mi size="s" class="mjx-i"><mjx-c c="3C4"></mjx-c></mjx-mi></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac></mjx-math></mjx-container>就能把这个错误放大许多倍，导致分母变大，损失增加。那个没被训练好的负例，就会被模型聚焦，被重点“关注”。<br>温度<mjx-container jax="CHTML" class="MathJax"><mjx-math class=" MJX-TEX"><mjx-mi class="mjx-i"><mjx-c c="3C4"></mjx-c></mjx-mi></mjx-math></mjx-container>可以用来召回结果的“记忆性”和“扩展性”，或者说，精度与多样性。</p> <ul><li>如果<mjx-container jax="CHTML" class="MathJax"><mjx-math class=" MJX-TEX"><mjx-mi class="mjx-i"><mjx-c c="3C4"></mjx-c></mjx-mi></mjx-math></mjx-container>设置得很小，它对错误的放大功能就很强。只要物料<mjx-container jax="CHTML" class="MathJax"><mjx-math class=" MJX-TEX"><mjx-msub><mjx-mi noIC="true" class="mjx-i"><mjx-c c="t"></mjx-c></mjx-mi><mjx-script style="vertical-align:-0.15em;"><mjx-mi size="s" class="mjx-i"><mjx-c c="j"></mjx-c></mjx-mi></mjx-script></mjx-msub></mjx-math></mjx-container>未被用户<mjx-container jax="CHTML" class="MathJax"><mjx-math class=" MJX-TEX"><mjx-msub><mjx-mi noIC="true" class="mjx-i"><mjx-c c="u"></mjx-c></mjx-mi><mjx-script style="vertical-align:-0.15em;"><mjx-mi size="s" class="mjx-i"><mjx-c c="i"></mjx-c></mjx-mi></mjx-script></mjx-msub></mjx-math></mjx-container>点击过，模型就会强力将它们拉开。但是我们知道<mjx-container jax="CHTML" class="MathJax"><mjx-math class=" MJX-TEX"><mjx-msub><mjx-mi noIC="true" class="mjx-i"><mjx-c c="t"></mjx-c></mjx-mi><mjx-script style="vertical-align:-0.15em;"><mjx-mi size="s" class="mjx-i"><mjx-c c="j"></mjx-c></mjx-mi></mjx-script></mjx-msub></mjx-math></mjx-container>是负采样得到的，它未被<mjx-container jax="CHTML" class="MathJax"><mjx-math class=" MJX-TEX"><mjx-mi class="mjx-i"><mjx-c c="u"></mjx-c></mjx-mi></mjx-math></mjx-container>点击，可能只是还没有曝光给<mjx-container jax="CHTML" class="MathJax"><mjx-math class=" MJX-TEX"><mjx-msub><mjx-mi noIC="true" class="mjx-i"><mjx-c c="u"></mjx-c></mjx-mi><mjx-script style="vertical-align:-0.15em;"><mjx-mi size="s" class="mjx-i"><mjx-c c="i"></mjx-c></mjx-mi></mjx-script></mjx-msub></mjx-math></mjx-container>而已。所以<mjx-container jax="CHTML" class="MathJax"><mjx-math class=" MJX-TEX"><mjx-mi class="mjx-i"><mjx-c c="3C4"></mjx-c></mjx-mi></mjx-math></mjx-container>很小的话，将使模型牢牢记住用户历史点击反映出的兴趣爱好，召回时不敢偏离太远。推荐结果的精度高，但对用户潜在兴趣覆盖得不够，容易使用户陷入信息茧房而疲劳。</li> <li>如果<mjx-container jax="CHTML" class="MathJax"><mjx-math class=" MJX-TEX"><mjx-mi class="mjx-i"><mjx-c c="3C4"></mjx-c></mjx-mi></mjx-math></mjx-container>设置大了，它对错误的放大功能就很弱。对负样本<mjx-container jax="CHTML" class="MathJax"><mjx-math class=" MJX-TEX"><mjx-mo class="mjx-n"><mjx-c c="("></mjx-c></mjx-mo><mjx-msub><mjx-mi noIC="true" class="mjx-i"><mjx-c c="u"></mjx-c></mjx-mi><mjx-script style="vertical-align:-0.15em;"><mjx-mi size="s" class="mjx-i"><mjx-c c="i"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c c=","></mjx-c></mjx-mo><mjx-msub space="2"><mjx-mi noIC="true" class="mjx-i"><mjx-c c="t"></mjx-c></mjx-mi><mjx-script style="vertical-align:-0.15em;"><mjx-mi size="s" class="mjx-i"><mjx-c c="j"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c c=")"></mjx-c></mjx-mo></mjx-math></mjx-container>，也不会将<mjx-container jax="CHTML" class="MathJax"><mjx-math class=" MJX-TEX"><mjx-msub><mjx-mi noIC="true" class="mjx-i"><mjx-c c="u"></mjx-c></mjx-mi><mjx-script style="vertical-align:-0.15em;"><mjx-mi size="s" class="mjx-i"><mjx-c c="i"></mjx-c></mjx-mi></mjx-script></mjx-msub></mjx-math></mjx-container>和<mjx-container jax="CHTML" class="MathJax"><mjx-math class=" MJX-TEX"><mjx-msub><mjx-mi noIC="true" class="mjx-i"><mjx-c c="t"></mjx-c></mjx-mi><mjx-script style="vertical-align:-0.15em;"><mjx-mi size="s" class="mjx-i"><mjx-c c="j"></mjx-c></mjx-mi></mjx-script></mjx-msub></mjx-math></mjx-container>拉开得非常远，召回时仍有可能将<mjx-container jax="CHTML" class="MathJax"><mjx-math class=" MJX-TEX"><mjx-msub><mjx-mi noIC="true" class="mjx-i"><mjx-c c="t"></mjx-c></mjx-mi><mjx-script style="vertical-align:-0.15em;"><mjx-mi size="s" class="mjx-i"><mjx-c c="j"></mjx-c></mjx-mi></mjx-script></mjx-msub></mjx-math></mjx-container>当成<mjx-container jax="CHTML" class="MathJax"><mjx-math class=" MJX-TEX"><mjx-msub><mjx-mi noIC="true" class="mjx-i"><mjx-c c="u"></mjx-c></mjx-mi><mjx-script style="vertical-align:-0.15em;"><mjx-mi size="s" class="mjx-i"><mjx-c c="i"></mjx-c></mjx-mi></mjx-script></mjx-msub></mjx-math></mjx-container>的近邻推荐出去。好处是，<mjx-container jax="CHTML" class="MathJax"><mjx-math class=" MJX-TEX"><mjx-msub><mjx-mi noIC="true" class="mjx-i"><mjx-c c="t"></mjx-c></mjx-mi><mjx-script style="vertical-align:-0.15em;"><mjx-mi size="s" class="mjx-i"><mjx-c c="j"></mjx-c></mjx-mi></mjx-script></mjx-msub></mjx-math></mjx-container>真的覆盖了用户的一部分隐藏兴趣，推荐<mjx-container jax="CHTML" class="MathJax"><mjx-math class=" MJX-TEX"><mjx-msub><mjx-mi noIC="true" class="mjx-i"><mjx-c c="t"></mjx-c></mjx-mi><mjx-script style="vertical-align:-0.15em;"><mjx-mi size="s" class="mjx-i"><mjx-c c="j"></mjx-c></mjx-mi></mjx-script></mjx-msub></mjx-math></mjx-container>是对用户兴趣的一次探索与扩展，丰富推荐结果的多样性，打破&quot;信息茧房&quot;。坏处是，有可能<mjx-container jax="CHTML" class="MathJax"><mjx-math class=" MJX-TEX"><mjx-msub><mjx-mi noIC="true" class="mjx-i"><mjx-c c="t"></mjx-c></mjx-mi><mjx-script style="vertical-align:-0.15em;"><mjx-mi size="s" class="mjx-i"><mjx-c c="j"></mjx-c></mjx-mi></mjx-script></mjx-msub></mjx-math></mjx-container>，真的不是<mjx-container jax="CHTML" class="MathJax"><mjx-math class=" MJX-TEX"><mjx-msub><mjx-mi noIC="true" class="mjx-i"><mjx-c c="u"></mjx-c></mjx-mi><mjx-script style="vertical-align:-0.15em;"><mjx-mi size="s" class="mjx-i"><mjx-c c="i"></mjx-c></mjx-mi></mjx-script></mjx-msub></mjx-math></mjx-container>的&quot;菜&quot;，召回把关太松，有损用户体验。</li></ul> <h3 id="采样修正的q-t-应该如何设置"><a href="#采样修正的q-t-应该如何设置" class="header-anchor">#</a> 采样修正的Q(t)应该如何设置？</h3> <p>公式中的<mjx-container jax="CHTML" class="MathJax"><mjx-math class=" MJX-TEX"><mjx-mi class="mjx-i"><mjx-c c="Q"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c c="("></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c c="t"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c c=")"></mjx-c></mjx-mo></mjx-math></mjx-container>表示负采样到某个物料<mjx-container jax="CHTML" class="MathJax"><mjx-math class=" MJX-TEX"><mjx-mi class="mjx-i"><mjx-c c="t"></mjx-c></mjx-mi></mjx-math></mjx-container>的概率。如果我们使用<mjx-container jax="CHTML" class="MathJax"><mjx-math class=" MJX-TEX"><mjx-mi class="mjx-i"><mjx-c c="B"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c c="a"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c c="t"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c c="c"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c c="h"></mjx-c></mjx-mi></mjx-math></mjx-container>内负采样而且样本来自点击数据，<mjx-container jax="CHTML" class="MathJax"><mjx-math class=" MJX-TEX"><mjx-mi class="mjx-i"><mjx-c c="Q"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c c="("></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c c="t"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c c=")"></mjx-c></mjx-mo></mjx-math></mjx-container>就等于物料<mjx-container jax="CHTML" class="MathJax"><mjx-math class=" MJX-TEX"><mjx-mi class="mjx-i"><mjx-c c="t"></mjx-c></mjx-mi></mjx-math></mjx-container>在所有点击样本中的占比，即<mjx-container jax="CHTML" class="MathJax"><mjx-math class=" MJX-TEX"><mjx-mi class="mjx-i"><mjx-c c="Q"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c c="("></mjx-c></mjx-mo><mjx-msub><mjx-mi noIC="true" class="mjx-i"><mjx-c c="t"></mjx-c></mjx-mi><mjx-script style="vertical-align:-0.15em;"><mjx-mi size="s" class="mjx-i"><mjx-c c="i"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c c=")"></mjx-c></mjx-mo><mjx-mo space="4" class="mjx-n"><mjx-c c="="></mjx-c></mjx-mo><mjx-mfrac space="4"><mjx-frac><mjx-num><mjx-nstrut></mjx-nstrut><mjx-mrow size="s"><mjx-mi class="mjx-i"><mjx-c c="C"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c c="("></mjx-c></mjx-mo><mjx-msub><mjx-mi noIC="true" class="mjx-i"><mjx-c c="t"></mjx-c></mjx-mi><mjx-script style="vertical-align:-0.15em;"><mjx-mi size="s" class="mjx-i"><mjx-c c="i"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c c=")"></mjx-c></mjx-mo></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line></mjx-line><mjx-row><mjx-den><mjx-dstrut></mjx-dstrut><mjx-mrow size="s"><mjx-munder limits="false"><mjx-mo class="mjx-sop"><mjx-c c="2211"></mjx-c></mjx-mo><mjx-script style="vertical-align:-0.285em;"><mjx-TeXAtom size="s"><mjx-msub><mjx-mi noIC="true" class="mjx-i"><mjx-c c="t"></mjx-c></mjx-mi><mjx-script style="vertical-align:-0.307em;"><mjx-mi class="mjx-i"><mjx-c c="j"></mjx-c></mjx-mi></mjx-script></mjx-msub></mjx-TeXAtom></mjx-script></mjx-munder><mjx-mi space="2" class="mjx-i"><mjx-c c="C"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c c="("></mjx-c></mjx-mo><mjx-msub><mjx-mi noIC="true" class="mjx-i"><mjx-c c="t"></mjx-c></mjx-mi><mjx-script style="vertical-align:-0.15em;"><mjx-mi size="s" class="mjx-i"><mjx-c c="j"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c c=")"></mjx-c></mjx-mo></mjx-mrow></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac></mjx-math></mjx-container> ，其中<mjx-container jax="CHTML" class="MathJax"><mjx-math class=" MJX-TEX"><mjx-mi class="mjx-i"><mjx-c c="C"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c c="("></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c c="t"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c c=")"></mjx-c></mjx-mo></mjx-math></mjx-container>表示物料<mjx-container jax="CHTML" class="MathJax"><mjx-math class=" MJX-TEX"><mjx-mi class="mjx-i"><mjx-c c="t"></mjx-c></mjx-mi></mjx-math></mjx-container>的点击次数。通常对精度要求没那么高，<mjx-container jax="CHTML" class="MathJax"><mjx-math class=" MJX-TEX"><mjx-mi class="mjx-i"><mjx-c c="Q"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c c="("></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c c="t"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c c=")"></mjx-c></mjx-mo></mjx-math></mjx-container>可以离线、定时统计得到。对精度要求高的，可以通过流式算法在线预估<mjx-container jax="CHTML" class="MathJax"><mjx-math class=" MJX-TEX"><mjx-mi class="mjx-i"><mjx-c c="Q"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c c="("></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c c="t"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c c=")"></mjx-c></mjx-mo></mjx-math></mjx-container>。<br>如果我们使用&quot;混合负采样&quot;，损失函数如下所示。<br><mjx-container jax="CHTML" class="MathJax"><mjx-math class=" MJX-TEX"><mjx-msub><mjx-mi noIC="true" class="mjx-i"><mjx-c c="L"></mjx-c></mjx-mi><mjx-script style="vertical-align:-0.15em;"><mjx-TeXAtom size="s"><mjx-mi class="mjx-i"><mjx-c c="T"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c c="o"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c c="w"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c c="e"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c c="r"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-script></mjx-msub><mjx-mo space="4" class="mjx-n"><mjx-c c="="></mjx-c></mjx-mo><mjx-mo space="4" class="mjx-n"><mjx-c c="2212"></mjx-c></mjx-mo><mjx-mfrac><mjx-frac><mjx-num><mjx-nstrut></mjx-nstrut><mjx-mn size="s" class="mjx-n"><mjx-c c="1"></mjx-c></mjx-mn></mjx-num><mjx-dbox><mjx-dtable><mjx-line></mjx-line><mjx-row><mjx-den><mjx-dstrut></mjx-dstrut><mjx-mrow size="s"><mjx-mo class="mjx-n"><mjx-c c="|"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c c="B"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c c="|"></mjx-c></mjx-mo></mjx-mrow></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-munder space="2" limits="false"><mjx-mo class="mjx-sop"><mjx-c c="2211"></mjx-c></mjx-mo><mjx-script style="vertical-align:-0.285em;"><mjx-TeXAtom size="s"><mjx-mo class="mjx-n"><mjx-c c="("></mjx-c></mjx-mo><mjx-msub><mjx-mi noIC="true" class="mjx-i"><mjx-c c="u"></mjx-c></mjx-mi><mjx-script style="vertical-align:-0.15em;"><mjx-mi size="s" class="mjx-i"><mjx-c c="i"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c c=","></mjx-c></mjx-mo><mjx-msub><mjx-mi noIC="true" class="mjx-i"><mjx-c c="t"></mjx-c></mjx-mi><mjx-script style="vertical-align:-0.15em;"><mjx-mi size="s" class="mjx-i"><mjx-c c="i"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c c=")"></mjx-c></mjx-mo><mjx-mo class="mjx-n"><mjx-c c="2208"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c c="B"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-script></mjx-munder><mjx-mi space="2" class="mjx-i"><mjx-c c="l"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c c="o"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c c="g"></mjx-c></mjx-mi><mjx-mfrac><mjx-frac><mjx-num><mjx-nstrut></mjx-nstrut><mjx-mrow size="s"><mjx-mi class="mjx-i"><mjx-c c="e"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c c="x"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c c="p"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c c="("></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c c="G"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c c="("></mjx-c></mjx-mo><mjx-msub><mjx-mi noIC="true" class="mjx-i"><mjx-c c="u"></mjx-c></mjx-mi><mjx-script style="vertical-align:-0.15em;"><mjx-mi size="s" class="mjx-i"><mjx-c c="i"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c c=","></mjx-c></mjx-mo><mjx-msub><mjx-mi noIC="true" class="mjx-i"><mjx-c c="t"></mjx-c></mjx-mi><mjx-script style="vertical-align:-0.15em;"><mjx-mi size="s" class="mjx-i"><mjx-c c="i"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c c=")"></mjx-c></mjx-mo><mjx-mo class="mjx-n"><mjx-c c=")"></mjx-c></mjx-mo></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line></mjx-line><mjx-row><mjx-den><mjx-dstrut></mjx-dstrut><mjx-mrow size="s"><mjx-mi class="mjx-i"><mjx-c c="e"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c c="x"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c c="p"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c c="("></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c c="G"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c c="("></mjx-c></mjx-mo><mjx-msub><mjx-mi noIC="true" class="mjx-i"><mjx-c c="u"></mjx-c></mjx-mi><mjx-script style="vertical-align:-0.15em;"><mjx-mi size="s" class="mjx-i"><mjx-c c="i"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c c=","></mjx-c></mjx-mo><mjx-msub><mjx-mi noIC="true" class="mjx-i"><mjx-c c="t"></mjx-c></mjx-mi><mjx-script style="vertical-align:-0.15em;"><mjx-mi size="s" class="mjx-i"><mjx-c c="i"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c c=")"></mjx-c></mjx-mo><mjx-mo class="mjx-n"><mjx-c c=")"></mjx-c></mjx-mo><mjx-mo class="mjx-n"><mjx-c c="+"></mjx-c></mjx-mo><mjx-munder limits="false"><mjx-mo class="mjx-sop"><mjx-c c="2211"></mjx-c></mjx-mo><mjx-script style="vertical-align:-0.299em;"><mjx-TeXAtom size="s"><mjx-mi class="mjx-i"><mjx-c c="j"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c c="2208"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c c="B"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c c="+"></mjx-c></mjx-mo><mjx-msup><mjx-mi class="mjx-i"><mjx-c c="B"></mjx-c></mjx-mi><mjx-script style="vertical-align:0.363em;"><mjx-mo class="mjx-n"><mjx-c c="2032"></mjx-c></mjx-mo></mjx-script></mjx-msup><mjx-mo class="mjx-n"><mjx-c c=","></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c c="j"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c c="2260"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c c="i"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-script></mjx-munder><mjx-mi space="2" class="mjx-i"><mjx-c c="e"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c c="x"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c c="p"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c c="("></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c c="G"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c c="("></mjx-c></mjx-mo><mjx-msub><mjx-mi noIC="true" class="mjx-i"><mjx-c c="u"></mjx-c></mjx-mi><mjx-script style="vertical-align:-0.15em;"><mjx-mi size="s" class="mjx-i"><mjx-c c="i"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c c=","></mjx-c></mjx-mo><mjx-msub><mjx-mi noIC="true" class="mjx-i"><mjx-c c="t"></mjx-c></mjx-mi><mjx-script style="vertical-align:-0.15em;"><mjx-mi size="s" class="mjx-i"><mjx-c c="j"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c c=")"></mjx-c></mjx-mo><mjx-mo class="mjx-n"><mjx-c c=")"></mjx-c></mjx-mo></mjx-mrow></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac></mjx-math></mjx-container></p> <ul><li>与上题中唯一的不同之处就是在生成负样本时，引入额外的负样本B，B代表之前生成的物料向量的缓存</li></ul> <p>因为现在负采样来自两种采样策略，因此<mjx-container jax="CHTML" class="MathJax"><mjx-math class=" MJX-TEX"><mjx-mi class="mjx-i"><mjx-c c="Q"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c c="("></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c c="t"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c c=")"></mjx-c></mjx-mo></mjx-math></mjx-container>也是一个组合概率，如公式所示。<br><mjx-container jax="CHTML" class="MathJax"><mjx-math class=" MJX-TEX"><mjx-mi class="mjx-i"><mjx-c c="Q"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c c="("></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c c="t"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c c=")"></mjx-c></mjx-mo><mjx-mo space="4" class="mjx-n"><mjx-c c="="></mjx-c></mjx-mo><mjx-mfrac space="4"><mjx-frac><mjx-num><mjx-nstrut></mjx-nstrut><mjx-mrow size="s"><mjx-mo class="mjx-n"><mjx-c c="|"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c c="B"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c c="|"></mjx-c></mjx-mo></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line></mjx-line><mjx-row><mjx-den><mjx-dstrut></mjx-dstrut><mjx-mrow size="s"><mjx-mo class="mjx-n"><mjx-c c="|"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c c="B"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c c="|"></mjx-c></mjx-mo><mjx-mo class="mjx-n"><mjx-c c="+"></mjx-c></mjx-mo><mjx-mo class="mjx-n"><mjx-c c="|"></mjx-c></mjx-mo><mjx-msup><mjx-mi class="mjx-i"><mjx-c c="B"></mjx-c></mjx-mi><mjx-script style="vertical-align:0.363em;"><mjx-mo size="s" class="mjx-n"><mjx-c c="2032"></mjx-c></mjx-mo></mjx-script></mjx-msup><mjx-mo class="mjx-n"><mjx-c c="|"></mjx-c></mjx-mo></mjx-mrow></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-msub><mjx-mi noIC="true" class="mjx-i"><mjx-c c="Q"></mjx-c></mjx-mi><mjx-script style="vertical-align:-0.177em;"><mjx-TeXAtom size="s"><mjx-mi class="mjx-i"><mjx-c c="i"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c c="n"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c c="2212"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c c="b"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c c="a"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c c="t"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c c="c"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c c="h"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c c="("></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c c="t"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c c=")"></mjx-c></mjx-mo></mjx-TeXAtom></mjx-script></mjx-msub><mjx-mo space="3" class="mjx-n"><mjx-c c="+"></mjx-c></mjx-mo><mjx-mfrac space="3"><mjx-frac><mjx-num><mjx-nstrut></mjx-nstrut><mjx-mrow size="s"><mjx-mo class="mjx-n"><mjx-c c="|"></mjx-c></mjx-mo><mjx-msup><mjx-mi class="mjx-i"><mjx-c c="B"></mjx-c></mjx-mi><mjx-script style="vertical-align:0.363em;"><mjx-mo size="s" class="mjx-n"><mjx-c c="2032"></mjx-c></mjx-mo></mjx-script></mjx-msup><mjx-mo class="mjx-n"><mjx-c c="|"></mjx-c></mjx-mo></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line></mjx-line><mjx-row><mjx-den><mjx-dstrut></mjx-dstrut><mjx-mrow size="s"><mjx-mo class="mjx-n"><mjx-c c="|"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c c="B"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c c="|"></mjx-c></mjx-mo><mjx-mo class="mjx-n"><mjx-c c="+"></mjx-c></mjx-mo><mjx-mo class="mjx-n"><mjx-c c="|"></mjx-c></mjx-mo><mjx-msup><mjx-mi class="mjx-i"><mjx-c c="B"></mjx-c></mjx-mi><mjx-script style="vertical-align:0.363em;"><mjx-mo size="s" class="mjx-n"><mjx-c c="2032"></mjx-c></mjx-mo></mjx-script></mjx-msup><mjx-mo class="mjx-n"><mjx-c c="|"></mjx-c></mjx-mo></mjx-mrow></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-msub><mjx-mi noIC="true" class="mjx-i"><mjx-c c="Q"></mjx-c></mjx-mi><mjx-script style="vertical-align:-0.177em;"><mjx-TeXAtom size="s"><mjx-mi class="mjx-i"><mjx-c c="c"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c c="a"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c c="c"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c c="h"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c c="e"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c c="("></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c c="t"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c c=")"></mjx-c></mjx-mo></mjx-TeXAtom></mjx-script></mjx-msub></mjx-math></mjx-container></p> <ul><li><mjx-container jax="CHTML" class="MathJax"><mjx-math class=" MJX-TEX"><mjx-msub><mjx-mi noIC="true" class="mjx-i"><mjx-c c="Q"></mjx-c></mjx-mi><mjx-script style="vertical-align:-0.15em;"><mjx-TeXAtom size="s"><mjx-mi class="mjx-i"><mjx-c c="i"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c c="n"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c c="2212"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c c="b"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c c="a"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c c="t"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c c="c"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c c="h"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c c="("></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c c="t"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c c=")"></mjx-c></mjx-mo></mjx-math></mjx-container>就是Batch内负采样的概率，前边已经介绍过了，就等于物料t在所有点击样本中的占比。</li> <li><mjx-container jax="CHTML" class="MathJax"><mjx-math class=" MJX-TEX"><mjx-msub><mjx-mi noIC="true" class="mjx-i"><mjx-c c="Q"></mjx-c></mjx-mi><mjx-script style="vertical-align:-0.15em;"><mjx-TeXAtom size="s"><mjx-mi class="mjx-i"><mjx-c c="c"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c c="a"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c c="c"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c c="h"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c c="e"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c c="("></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c c="t"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c c=")"></mjx-c></mjx-mo></mjx-math></mjx-container>是在&quot;物料向量缓存&quot;<mjx-container jax="CHTML" class="MathJax"><mjx-math class=" MJX-TEX"><mjx-msup><mjx-mi class="mjx-i"><mjx-c c="B"></mjx-c></mjx-mi><mjx-script style="vertical-align:0.363em;"><mjx-mo size="s" class="mjx-n"><mjx-c c="2032"></mjx-c></mjx-mo></mjx-script></mjx-msup></mjx-math></mjx-container>中采到物料<mjx-container jax="CHTML" class="MathJax"><mjx-math class=" MJX-TEX"><mjx-mi class="mjx-i"><mjx-c c="t"></mjx-c></mjx-mi></mjx-math></mjx-container>的概率。如果在缓存中平均采样，<mjx-container jax="CHTML" class="MathJax"><mjx-math class=" MJX-TEX"><mjx-msub><mjx-mi noIC="true" class="mjx-i"><mjx-c c="Q"></mjx-c></mjx-mi><mjx-script style="vertical-align:-0.15em;"><mjx-TeXAtom size="s"><mjx-mi class="mjx-i"><mjx-c c="c"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c c="a"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c c="c"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c c="h"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c c="e"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c c="("></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c c="t"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c c=")"></mjx-c></mjx-mo><mjx-mo space="4" class="mjx-n"><mjx-c c="="></mjx-c></mjx-mo><mjx-mfrac space="4"><mjx-frac><mjx-num><mjx-nstrut></mjx-nstrut><mjx-mn size="s" class="mjx-n"><mjx-c c="1"></mjx-c></mjx-mn></mjx-num><mjx-dbox><mjx-dtable><mjx-line></mjx-line><mjx-row><mjx-den><mjx-dstrut></mjx-dstrut><mjx-mrow size="s"><mjx-mi class="mjx-i"><mjx-c c="C"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c c="a"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c c="c"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c c="h"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c c="e"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c c="S"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c c="i"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c c="z"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c c="e"></mjx-c></mjx-mi></mjx-mrow></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac></mjx-math></mjx-container>CacheSize就是&quot;向量缓存&quot;的大小。</li></ul></div></section> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev"><a href="/recommend-system/5.1.html" class="prev">
            5.1-传统召回
          </a></span> <span class="next"><a href="/recommend-system/5.3.html">
            5.3-FM召回
          </a></span></p></div> <div class="comments-wrapper"><!----></div> <ul class="side-bar sub-sidebar-wrapper" style="width:0;" data-v-70334359></ul></main> <!----></div></div></div></div><div class="global-ui"><div class="back-to-ceiling" style="right:1rem;bottom:6rem;width:2.5rem;height:2.5rem;border-radius:.25rem;line-height:2.5rem;display:none;" data-v-c6073ba8 data-v-c6073ba8><svg t="1574745035067" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5404" class="icon" data-v-c6073ba8><path d="M526.60727968 10.90185116a27.675 27.675 0 0 0-29.21455937 0c-131.36607665 82.28402758-218.69155461 228.01873535-218.69155402 394.07834331a462.20625001 462.20625001 0 0 0 5.36959153 69.94390903c1.00431239 6.55289093-0.34802892 13.13561351-3.76865779 18.80351572-32.63518765 54.11355614-51.75690182 118.55860487-51.7569018 187.94566865a371.06718723 371.06718723 0 0 0 11.50484808 91.98906777c6.53300375 25.50556257 41.68394495 28.14064038 52.69160883 4.22606766 17.37162448-37.73630017 42.14135425-72.50938081 72.80769204-103.21549295 2.18761121 3.04276886 4.15646224 6.24463696 6.40373557 9.22774369a1871.4375 1871.4375 0 0 0 140.04691725 5.34970492 1866.36093723 1866.36093723 0 0 0 140.04691723-5.34970492c2.24727335-2.98310674 4.21612437-6.18497483 6.3937923-9.2178004 30.66633723 30.70611158 55.4360664 65.4791928 72.80769147 103.21549355 11.00766384 23.91457269 46.15860503 21.27949489 52.69160879-4.22606768a371.15156223 371.15156223 0 0 0 11.514792-91.99901164c0-69.36717486-19.13165746-133.82216804-51.75690182-187.92578088-3.42062944-5.66790279-4.76302748-12.26056868-3.76865837-18.80351632a462.20625001 462.20625001 0 0 0 5.36959269-69.943909c-0.00994388-166.08943902-87.32547796-311.81420293-218.6915546-394.09823051zM605.93803103 357.87693858a93.93749974 93.93749974 0 1 1-187.89594924 6.1e-7 93.93749974 93.93749974 0 0 1 187.89594924-6.1e-7z" p-id="5405" data-v-c6073ba8></path><path d="M429.50777625 765.63860547C429.50777625 803.39355007 466.44236686 1000.39046097 512.00932183 1000.39046097c45.56695499 0 82.4922232-197.00623328 82.5015456-234.7518555 0-37.75494459-36.9345906-68.35043303-82.4922232-68.34111062-45.57627738-0.00932239-82.52019037 30.59548842-82.51086798 68.34111062z" p-id="5406" data-v-c6073ba8></path></svg></div><!----></div></div>
    <script src="/assets/js/app.8518e532.js" defer></script><script src="/assets/js/3.01b1ada6.js" defer></script><script src="/assets/js/1.f343df0c.js" defer></script><script src="/assets/js/61.52a7d43a.js" defer></script>
  </body>
</html>
